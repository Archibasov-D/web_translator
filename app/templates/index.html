<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Translator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
<div class="container mt-5 p-4 bg-white rounded shadow" style="max-width: 700px">
    <h2 class="mb-4 text-center">Simple Translator</h2>

    <label class="form-label">Enter text:</label>
    <textarea id="text" class="form-control mb-3" rows="4"></textarea>

    <label class="form-label">Select tokenizer flag:</label>
    <select id="flag" class="form-select mb-4">
        <option value="en">English</option>
        <option value="de">German</option>
        <option value="fr">French</option>
        <option value="ru">Russian</option>
    </select>

    <button id="translateBtn" class="btn btn-primary w-100 mb-4">Translate</button>

    <div id="result" class="alert alert-success" style="min-height: 50px"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const btn = document.getElementById("translateBtn");
    btn.addEventListener("click", translateText);
});

async function translateText(event) {
    const btn = document.getElementById("translateBtn");
    const resultDiv = document.getElementById("result");
    const text = document.getElementById("text").value.trim();
    const flag = document.getElementById("flag").value;

    if (!text) {
        resultDiv.innerText = "Please enter text to translate.";
        return;
    }

    // UI: заблокировать кнопку и показать индикатор
    btn.disabled = true;
    const prev = resultDiv.innerText;
    resultDiv.innerText = "Translating...";

    try {
        const res = await fetch("/predict", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ text: text, flag: flag })
        });

        if (!res.ok) {
            const txt = await res.text();
            throw new Error(`Server returned ${res.status}: ${txt}`);
        }

        const data = await res.json();

        // <-- здесь ключ "translation", как в вашем FastAPI
        resultDiv.innerText = data.translation ?? "No translation returned.";
    } catch (err) {
        console.error(err);
        resultDiv.innerText = "Error: " + (err.message || err);
    } finally {
        btn.disabled = false;
    }
}
</script>

</body>
</html>

